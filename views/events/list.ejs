<!DOCTYPE html>
<html>
<head>
  <title>Events</title>
  <link rel="stylesheet" href="/css/main.css">
</head>
<body>

<%- include('../partials/_nav') %>
<%- include('../partials/_flash') %>

<h1>Events</h1>

<% if (currentUser.role === 'manager') { %>
  <p><a href="/events/new">Add Event</a></p>
<% } %>

<table border="1" cellpadding="6">
  <tr>
    <th>Name</th>
    <th>Type</th>
    <th>Recurrence</th>
    <th>Default Capacity</th>
    <th>Description</th>
    <% if (currentUser.role === 'manager') { %><th>Actions</th><% } %>
  </tr>

  <% events.forEach(evt => { %>
    <tr>
      <td><%= evt.eventname %></td>
      <td><%= evt.eventtype || '' %></td>
      <td><%= evt.eventrecurrencepattern || '' %></td>
      <td><%= evt.eventdefaultcapacity || '' %></td>
      <td><%= evt.eventdescription || '' %></td>

      <% if (currentUser.role === 'manager') { %>
        <td>
          <a href="/events/<%= evt.eventname %>/edit">Edit</a>
          <form action="/events/<%= evt.eventname %>/delete" method="POST" style="display:inline;">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
            <button type="submit">Delete</button>
          </form>
        </td>
      <% } %>
    </tr>
  <% }) %>
</table>

</body>
</html>
