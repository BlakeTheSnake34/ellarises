<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title><%= title || 'Program Dashboard | Ella Rises' %></title>

  <link rel="stylesheet" href="/css/main.css">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    .dashboard-embed {
      margin-top: 1.5rem;
    }

    .dashboard-embed .tableauPlaceholder {
      width: 100%;
      height: 100vh;
      position: relative;
    }
  </style>
</head>

<body>

  <%- include('../partials/_nav') %>
  <%- include('../partials/_flash') %>

  <div class="page-wrap survey-wide">
    <div class="page survey-wide-page">
      <h1>Program Dashboard</h1>

      <p class="home-subtitle" style="margin-bottom: 1.25rem;">
        This dashboard brings together key Ella Rises metrics including participation,
        events, surveys, and donations to help managers understand program progress
        at a glance.
      </p>

      <div class="dashboard-embed">
        <div class="tableauPlaceholder" id="ellaDashboardViz" style="position: relative;">
          <noscript>
            <a href="#">
              <img
                alt="Ella Rises program dashboard"
                src="https://public.tableau.com/static/images/In/IntexDashboard-Group6/Dashboard1/1_rss.png"
                style="border: none;"
              />
            </a>
          </noscript>

          <object class="tableauViz" style="display:none;">
            <param name="host_url" value="https%3A%2F%2Fpublic.tableau.com%2F" />
            <param name="embed_code_version" value="3" />
            <param name="site_root" value="" />
            <param name="name" value="IntexDashboard-Group6/Dashboard1" />
            <param name="tabs" value="yes" />
            <param name="toolbar" value="yes" />
            <param name="static_image"
                   value="https://public.tableau.com/static/images/In/IntexDashboard-Group6/Dashboard1/1.png" />
            <param name="animate_transition" value="yes" />
            <param name="display_static_image" value="yes" />
            <param name="display_spinner" value="yes" />
            <param name="display_overlay" value="yes" />
            <param name="display_count" value="yes" />
            <param name="language" value="en-US" />
          </object>
        </div>
      </div>

      <script type="text/javascript">
        const divElement = document.getElementById('ellaDashboardViz');
        const vizElement = divElement.getElementsByTagName('object')[0];

        if (divElement.offsetWidth > 800) {
          vizElement.style.minWidth = '1500px';
          vizElement.style.maxWidth = '100%';
          vizElement.style.minHeight = '1150px';
          vizElement.style.maxHeight = (divElement.offsetWidth * 0.75) + 'px';
        } else if (divElement.offsetWidth > 500) {
          vizElement.style.minWidth = '1500px';
          vizElement.style.maxWidth = '100%';
          vizElement.style.minHeight = '1150px';
          vizElement.style.maxHeight = (divElement.offsetWidth * 0.75) + 'px';
        } else {
          vizElement.style.width = '100%';
          vizElement.style.minHeight = '2250px';
          vizElement.style.maxHeight = (divElement.offsetWidth * 1.77) + 'px';
        }

        const scriptElement = document.createElement('script');
        scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
        vizElement.parentNode.insertBefore(scriptElement, vizElement);
      </script>

    </div>
  </div>
  <%- include('../partials/_footer') %>
</body>
</html>

